@{
    import {setData, getData} from './store'
    function me(i){
        console.log('have: ' + getData())
        setData(i.length);
        console.log(getData())
        write('cool -' + i)
    }
}

@__filename

<form sendTo="me">
    <input name="am" value="more--------++"/>
</form>


@{ 
    function checkLogin(name, password){
        if(testLogin(mail, password))
            return Response.redirect('/');
        write('<p>Wrong email or password</p>');
    }
}

<form action="post" sendTo="checkLogin" validator="email:email,password:6:30">
    <input type="email" name="email" placeholder="Enter your email address"/>
    <input type="password" name="password" placeholder="Enter your password"/>
    <button type="submit">Submit</button>
</form>

@{
    async function userMessage(text, userId){
        try {
            await sendMessageToUser(text, userId, Session.userId)
            return "Message sent"
        } catch {
            return "Can't send message - make sure this use exists"
        }
    }
}
<connect sendTo="userMessage" name="sendMessageServer" validator="text: 1:200,userId:integer"/>

<input type="number" id="userId" placeholder="User Id"/>
<textarea id="message" name="message" placeholder="Enter your message"></textarea>
<button onclick="sendMessage()">Send Message</button>
<script>
    const $ = x => document.querySelector(x);

    async function sendMessage(){
        alert(await sendMessageServer($('#userId').value, $('#message').value))
    }
</script>

@transfer('./index')
<form action="post" sendTo="checkLogin">
    <input type="email" name="email" placeholder="Enter your email address"/>
    <input type="password" name="password" placeholder="Enter your password"/>
    <button type="submit">Submit</button>
</form>

